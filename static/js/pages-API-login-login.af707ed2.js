(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-API-login-login"],{"780c":function(i,e,n){"use strict";n.r(e);var t=n("ef8a"),o=n("938d");for(var a in o)["default"].indexOf(a)<0&&function(i){n.d(e,i,(function(){return o[i]}))}(a);n("feb0");var s,u=n("f0c5"),r=Object(u["a"])(o["default"],t["b"],t["c"],!1,null,"69cdadf7",null,!1,t["a"],s);e["default"]=r.exports},"938d":function(i,e,n){"use strict";n.r(e);var t=n("e596"),o=n.n(t);for(var a in t)["default"].indexOf(a)<0&&function(i){n.d(e,i,(function(){return t[i]}))}(a);e["default"]=o.a},b4a7:function(i,e,n){var t=n("c2ba");"string"===typeof t&&(t=[[i.i,t,""]]),t.locals&&(i.exports=t.locals);var o=n("4f06").default;o("25f7b8e8",t,!0,{sourceMap:!1,shadowMode:!1})},c2ba:function(i,e,n){var t=n("24fb");e=t(!1),e.push([i.i,"uni-button[data-v-69cdadf7]{background-color:#007aff;color:#fff}",""]),i.exports=e},e596:function(i,e,n){"use strict";var t=n("4ea4");n("d81d"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=t(n("5530")),a=n("2f62"),s="univerifyInfo",u={data:function(){return{title:"login",providerList:[],phoneNumber:"",univerifyBtnDisabled:!0}},computed:(0,o.default)({},(0,a.mapState)(["hasLogin","isUniverifyLogin"])),onLoad:function(){var i=this;uni.getProvider({service:"oauth",success:function(e){i.providerList=e.provider.map((function(e){var n="";switch(e){case"weixin":n="微信登录";break;case"qq":n="QQ登录";break;case"sinaweibo":n="新浪微博登录";break;case"xiaomi":n="小米登录";break;case"alipay":n="支付宝登录";break;case"baidu":n="百度登录";break;case"toutiao":n="头条登录";break;case"apple":n="苹果登录";break;case"univerify":uni.preLogin({provider:e,success:function(e){console.log("preLogin success: ",e),i.univerifyBtnDisabled=!1},fail:function(e){console.log("preLogin fail: ",e),console.log("preLogin fail: ",e.errCode),console.log("preLogin fail: ",e.errMsg),i.setUniverifyLogin(!1)}}),n="一键登录";break}return{name:n,id:e}}))},fail:function(i){console.log("获取登录通道失败",i)}}),uni.onAuthViewOtherLoginButtonClick((function(){uni.closeAuthView(),i.Toast({title:"其他登录方式"})})),this.hasLogin&&this.isUniverifyLogin&&this.getPhoneNumber(uni.getStorageSync(s))},methods:(0,o.default)((0,o.default)({},(0,a.mapMutations)(["login","setUniverifyLogin"])),{},{Toast:function(i){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;uni.showToast(Object.assign({},i,{duration:e}))},tologin:function(i){var e=this;uni.login({provider:i.id,success:function(n){if(console.log("login success:",n),e.login(i.id),"univerify"===i.id){e.setUniverifyLogin(!0),uni.closeAuthView();var t=n.authResult,o=t.access_token,a=t.openid,s={provider:i.id,accessToken:o,openid:a};e.getPhoneNumber(s)}else e.setUniverifyLogin(!1)},fail:function(i){console.log("login fail:",i)}})},getPhoneNumber:function(i){var e=this;uni.request({url:"https://97fca9f2-41f6-449f-a35e-3f135d4c3875.bspapp.com/http/univerify-login",method:"POST",data:i,success:function(n){console.log(n);var t=n.data;t.success?(e.phoneNumber=t.phoneNumber,uni.setStorageSync(s,i)):(e.Toast({icon:"none",title:"手机号获取失败"}),console.error(n))},fail:function(i){e.Toast({title:"一键登录失败"})}})}})};e.default=u},ef8a:function(i,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return t}));var t={pageHead:n("0586").default},o=function(){var i=this,e=i.$createElement,n=i._self._c||e;return n("v-uni-view",[n("page-head",{attrs:{title:i.title}}),n("v-uni-view",{staticClass:"uni-padding-wrap"},[n("v-uni-view",{staticStyle:{background:"#FFF",padding:"40rpx"}},[!0===i.hasLogin?[n("v-uni-view",{staticClass:"uni-h3 uni-center uni-common-mt"},[i._v("已登录"),i.isUniverifyLogin?n("v-uni-text",{staticStyle:{"font-size":"0.8em"}},[i.phoneNumber.length?n("i",[i._v("（"+i._s(i.phoneNumber)+"）")]):n("i",{staticClass:"uni-icon_toast uni-loading"})]):i._e()],1),n("v-uni-view",{staticClass:"uni-hello-text uni-center"},[n("v-uni-text",[i._v("每个账号仅需登录 1 次，\\n后续每次进入页面即可自动拉取用户信息。")])],1)]:i._e(),!1===i.hasLogin?[n("v-uni-view",{staticClass:"uni-h3 uni-center uni-common-mt"},[i._v("未登录")]),n("v-uni-view",{staticClass:"uni-hello-text uni-center"},[i._v("请点击按钮登录")])]:i._e()],2),n("v-uni-view",{staticClass:"uni-btn-v uni- uni-common-mt"},i._l(i.providerList,(function(e,t){return n("v-uni-button",{key:t,staticClass:"page-body-button",attrs:{type:"primary",disabled:"univerify"===e.id&&i.univerifyBtnDisabled},on:{click:function(n){arguments[0]=n=i.$handleEvent(n),i.tologin(e)}}},[i._v(i._s(e.name))])})),1)],1)],1)},a=[]},feb0:function(i,e,n){"use strict";var t=n("b4a7"),o=n.n(t);o.a}}]);